{% include "head.html" %} {% include "navbar.html" %} {% include 'weightEntry.html' %}

<head>
    {% block head %}{% endblock %}

    <link rel="stylesheet" href="//cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="//cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
</head>

<body>
    <main>
        {% block weightEntry %} {% endblock weightEntry %}

        <div id="tester" style="width:600px;height:250px;"></div>

        <script>
            $(document).ready(function() {
                plotInit();
                $.ajax({
                    type: "GET",
                    url: "http://192.168.1.63:8080/api/json/all",
                    dataType: 'json',
                    success: function(data) {
                        console.log(data)
                        fillTable(data)
                        $('#table').DataTable();
                    },
                    error: function(error) {
                        console.log("Here is the error res: " + JSON.stringify(error));
                    }
                });
            });

            function plotInit() {
                TESTER = document.getElementById('tester');
                Plotly.newPlot(TESTER, [{
                    x: [1, 2, 3, 4, 5],
                    y: [1, 2, 4, 8, 16]
                }], {
                    margin: {
                        t: 0
                    }
                });
            }

            function fillTable(response) {
                $.each(response, function(i, item) {
                    var $tr = $('#table').append(
                        '<tr id="table"> \
                <td>' + (item.id) + '</td> \
                <td>' + (item.weight) + " kg" + '</td> \
                <td>' + (item.timestamp) + '</td> \
                </tr>'
                    ).appendTo('#table');
                });
            }
        </script>
        {% block navbar %} {% endblock navbar %}
    </main>

    <script>
        $(document).ready(function() {

        });
    </script>
</body>